<?php

//------------------------------------------------------------------------------
// Statistics v2.0
//
// (c) Andrew Collington - amnuts@talker.com
// (c) Michael Doig      - michael@mike250.com
//------------------------------------------------------------------------------



function show_statistics_listing($db,$statistics,$id,$pr,$team,$week,$game_id)
{
	global $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

	if ($db->Exists("SELECT * FROM seasons")) {
		$db->QueryRow("SELECT la.season, se.SeasonName FROM tennis_scorecard_batting_details la INNER JOIN seasons se ON la.season = se.SeasonID WHERE se.SeasonName NOT LIKE '%KO%' GROUP BY la.season ORDER BY se.SeasonName DESC");

		echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
		echo "  <tr>\n";
		echo "    <td align=\"left\" valign=\"top\">\n";
		echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
		echo "<tr>\n";
		echo "  <td align=\"left\" valign=\"top\">\n";
		echo "  <a href=\"/index.php\">Home</a> &raquo; <font class=\"10px\">Statistics</font></p>\n";
		echo "  </td>\n";
		echo "  <td align=\"right\" valign=\"top\">\n";
		require ("/home/colora12/public_html/tennis/includes/navtop.php");
		echo "  </td>\n";
		echo "</tr>\n";
		echo "</table>\n";

		echo "<b class=\"16px\">Tennis Cricket Statistics</b><br><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////		
	// Statistics Select Box
	//////////////////////////////////////////////////////////////////////////////////////////		

		echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		echo "  <tr>\n";
		echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">SEASON SELECTOR</td>\n";
		echo "  </tr>\n";
		echo "  <tr>\n";
		echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\">\n";

       		echo "    <p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
		echo "    <option>year</option>\n";

		for ($i=0; $i<$db->rows; $i++) {
			$db->GetRow($i);
			$db->BagAndTag();

			// output
			$id = $db->data[SeasonID];
			$seasonname = $db->data[SeasonName];

			echo "    <option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">$seasonname</option>\n";
		}
		echo "    <option value=\"$PHP_SELF?statistics=&ccl_mode=1\">all</option>\n";
		echo "    </select></p>\n";

		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////		
	// Statistics Choices Box
	//////////////////////////////////////////////////////////////////////////////////////////		
		
		echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$greenbdr\" align=\"center\">\n";
		echo "  <tr>\n";
		echo "    <td bgcolor=\"$greenbdr\" class=\"whitemain\" height=\"23\">&nbsp;CAREER STATISTICS</td>\n";
		echo "  </tr>\n";
		echo "  <tr>\n";
		echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

		echo "<br><ul>\n";

		// Show by team statistics

		if ($db->Exists("SELECT * FROM tennisteams")) {
		$db->QueryRow("SELECT * FROM tennisteams WHERE TeamActive=1 ORDER BY TeamName");
			for ($x=0; $x<$db->rows; $x++) {
				$db->GetRow($x);
				$db->BagAndTag();
				$id = $db->data[TeamID];
				$ab = $db->data[TeamName];

		echo "<li><a href=\"$PHP_SELF?statistics=&team=$id&ccl_mode=2\">Career Team Averages: $ab</a></li>\n";
		}
	}

		echo "</ul>\n";		
		echo "<ul>\n";
		echo "<li><a href=\"$PHP_SELF?option=allcareer&sort=Average&sort2=Runs&ccl_mode=3\">Career Batting: Highest Averages</li>\n";
		echo "<li><a href=\"$PHP_SELF?option=allcareer&sort=Runs&sort2=Average&ccl_mode=3\">Career Batting: Most Runs</li>\n";
		echo "<li><a href=\"$PHP_SELF?option=allcareer&ccl_mode=4\">Career Batting: Highest Innings Scores</li>\n";
		echo "</ul>\n";
		echo "<ul>\n";			
		echo "<li><a href=\"$PHP_SELF?option=allcareer&sort=Average&direction=asc&ccl_mode=5\">Career Bowling: Best Averages</li>\n";
		echo "<li><a href=\"$PHP_SELF?option=allcareer&sort=Wickets&direction=desc&ccl_mode=5\">Career Bowling: Most Wickets</li>\n";
		echo "<li><a href=\"$PHP_SELF?option=allcareer&ccl_mode=6\">Career Bowling: Best Innings Performances</li>\n";
		echo "<li><a href=\"$PHP_SELF?option=allcareer&sort=Balls&direction=desc&ccl_mode=5\">Career Bowling: Workhorses</li>\n";
		echo "</ul>\n";				
		echo "<ul>\n";			
		echo "<li><a href=\"$PHP_SELF?option=allcareer&ccl_mode=7\">Career All-Round: 500 Runs & 50 Wickets</li>\n";
		echo "</ul>\n";	
		echo "</td>\n";
		echo "</tr>\n";
		echo "</table><br>\n";
		

		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table>\n";

		} else {

		echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
		echo "  <tr>\n";
		echo "    <td align=\"left\" valign=\"top\">\n";
		echo "    <p>There are no statistics in the database.</p>\n";
		echo "    <p>&laquo; <a href=\"/index.php\">back to homepage</a></p>\n";
		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table>\n";
	}
}



function show_statistics($db,$statistics,$id,$pr,$team,$week,$game_id)
{
        global $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

        if (!$db->Exists("SELECT * FROM tennis_scorecard_game_details")) {

 		echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
 		echo "  <tr>\n";
 		echo "    <td align=\"left\" valign=\"top\">\n";
		echo "    <a href=\"/index.php\">Home</a> &raquo; Statistics</p>\n";
	 	echo "    <p>There are currently no statisticsd games in the database.</p>\n";
		echo "    <p>&laquo; <a href=\"/index.php\">back to homepage</a></p>\n";
		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table>\n";

                return;

        } else {

                $db->Query("SELECT * FROM seasons ORDER BY SeasonID");
                for ($i=0; $i<$db->rows; $i++) {
                        $db->GetRow($i);
                        $seasons[$db->data[SeasonID]] = $db->data[SeasonName];
                }

                $db->Query("SELECT * FROM tennisteams ORDER BY TeamName");
                for ($i=0; $i<$db->rows; $i++) {
                        $db->GetRow($i);
                        $teams[$db->data[TeamID]] = $db->data[TeamAbbrev];
                }


		 	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
		 	echo "  <tr>\n";
		 	echo "    <td align=\"left\" valign=\"top\">\n";

			echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
			echo "<tr>\n";
			echo "  <td align=\"left\" valign=\"top\">\n";
			echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
			echo "  </td>\n";
			echo "  <td align=\"right\" valign=\"top\">\n";
			require ("/home/colora12/public_html/tennis/includes/navtop.php");
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";


			echo "<b class=\"16px\">$statistics Tennis Cricket Statistics</b><br><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Option Box
	//////////////////////////////////////////////////////////////////////////////////////////

		echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		echo "  <tr>\n";
		echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">OPTIONS</td>\n";
		echo "  </tr>\n";
		echo "  <tr>\n";
		echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\">\n";

		
		// List by season for schedule

		echo "<p class=\"10px\">Season: ";
		echo "<select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
		echo "<option value=\"\" selected>year</option>\n";

		$db->Query("SELECT la.season, se.SeasonName FROM scorecard_batting_details la INNER JOIN seasons se ON la.season = se.SeasonID WHERE se.SeasonName NOT LIKE '%KO%' GROUP BY la.season ORDER BY se.SeasonName DESC");
		for ($x=0; $x<$db->rows; $x++) {
			$db->GetRow($x);
			$db->BagAndTag();
			$sen = $db->data[SeasonName];
			$sid = $db->data[season];
		
		echo "    <option value=\"$PHP_SELF?statistics=$sen&ccl_mode=1\" class=\"10px\">$sen</option>\n";
		}
		echo "    <option value=\"$PHP_SELF?statistics=&ccl_mode=1\" class=\"10px\">all</option>\n";
		echo "    </select></p>\n";

		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table><br>\n";
		
	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Selections Box
	//////////////////////////////////////////////////////////////////////////////////////////
	
		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$greenbdr\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"$greenbdr\" class=\"whitemain\" height=\"23\">&nbsp;Select your statistics option</td>\n";
        	    	echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
			
			echo "<br><ul>\n";

			// Show by team statistics

			if ($db->Exists("SELECT * FROM tennisteams")) {
			$db->QueryRow("SELECT * FROM tennisteams ORDER BY TeamName");
				for ($x=0; $x<$db->rows; $x++) {
					$db->GetRow($x);
					$db->BagAndTag();
					$id = $db->data[TeamID];
					$ab = $db->data[TeamName];

				echo "<li><a href=\"$PHP_SELF?statistics=$statistics&team=$id&ccl_mode=2\">Team Averages: $ab</a></li>\n";
				}
		}

			echo "</ul>\n";
			echo "<ul>\n";
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&sort=Average&ccl_mode=3\">Batting: Highest Averages</li>\n";
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&sort=Runs&ccl_mode=3\">Batting: Most Runs</li>\n";
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&ccl_mode=4\">Batting: Highest Innings Scores</li>\n";
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&sort=sixes&ccl_mode=8\">Batting: Most Sixes</li>\n";
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&sort=fours&ccl_mode=8\">Batting: Most Fours</li>\n";
			echo "</ul>\n";
			echo "<ul>\n";			
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&sort=Average&direction=asc&ccl_mode=5\">Bowling: Best Averages</li>\n";
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&sort=Wickets&direction=desc&ccl_mode=5\">Bowling: Most Wickets</li>\n";
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&ccl_mode=6\">Bowling: Best Innings Performances</li>\n";
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&sort=Balls&direction=desc&ccl_mode=5\">Bowling: Workhorses</li>\n";
			echo "</ul>\n";				
			echo "<ul>\n";			
			echo "<li><a href=\"$PHP_SELF?statistics=$statistics&ccl_mode=7\">All-Round: 25 Runs & 3 Wickets</li>\n";
			echo "</ul>\n";	
			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";

			echo "    </td>\n";
			echo "  </tr>\n";
			echo "</table>\n";

        }
}



function show_statistics_team($db,$statistics,$id,$pr,$team,$week,$game_id)
{
        global $dbcfg, $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

	$db->Query("SELECT * FROM seasons ORDER BY SeasonID");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$seasons[$db->data[SeasonID]] = $db->data[SeasonName];
	}

	$db->Query("SELECT * FROM tennisteams ORDER BY TeamName");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$teams[$db->data[TeamID]] = $db->data[TeamName];
		$teamcolour[$db->data[TeamID]] = $db->data[TeamColour];
	}
                
        if (!$db->Exists("
	SELECT 
	  g.season, n.SeasonName, 
	  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, SUM( s.notout) AS Notouts,
	  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
	FROM 
	  tennis_scorecard_batting_details s
	INNER JOIN
	  tennisplayers p 
	ON 
	  s.player_id = p.PlayerID
	INNER JOIN
	  tennis_scorecard_game_details g
	ON
	  s.game_id = g.game_id
	INNER JOIN
	  seasons n 
	ON
	  g.season = n.SeasonID
	WHERE 
	  p.PlayerTeam = $team AND n.SeasonName LIKE '%{$statistics}%' 
	GROUP BY 
	  s.player_id        
        ")) {

	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";


	echo "<b class=\"16px\">$statistics Statistics for {$teams[$team]}</b><br><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Option Box
	//////////////////////////////////////////////////////////////////////////////////////////

		echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bordercolor=\"#{$teamcolour[$team]}\" align=\"center\">\n";
		echo "  <tr>\n";
		echo "    <td bgcolor=\"#{$teamcolour[$team]}\" class=\"whitemain\" height=\"23\">OPTIONS</td>\n";
		echo "  </tr>\n";
		echo "  <tr>\n";
		echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\">\n";

		
		// List by season for schedule

		echo "<p class=\"10px\">Season: ";
		echo "<select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
		echo "<option value=\"\" selected>year</option>\n";

		$db->Query("SELECT la.season, se.SeasonName FROM scorecard_batting_details la INNER JOIN seasons se ON la.season = se.SeasonID WHERE se.SeasonName NOT LIKE '%KO%' GROUP BY la.season ORDER BY se.SeasonName DESC");
		for ($x=0; $x<$db->rows; $x++) {
			$db->GetRow($x);
			$db->BagAndTag();
			$sen = $db->data[SeasonName];
			$sid = $db->data[season];
		
		echo "    <option value=\"$PHP_SELF?statistics=$sen&team=$team&ccl_mode=2\" class=\"10px\">$sen</option>\n";		
		}
		echo "    <option value=\"$PHP_SELF?statistics=&team=$team&ccl_mode=2\" class=\"10px\">all</option>\n";

		echo "    </select></p>\n";

		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Detail Box
	//////////////////////////////////////////////////////////////////////////////////////////

		
	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"#{$teamcolour[$team]}\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"#{$teamcolour[$team]}\" class=\"whitemain\" height=\"23\">&nbsp;<b>BATTING STATISTICS</b></td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
	
	echo " There are no statistics for this year for this team.\n";

	echo "</td>\n";
	echo "</tr>\n";
	echo "</table><br>\n";
	
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";	
			
                return;

        } else {

		 	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
		 	echo "  <tr>\n";
		 	echo "    <td align=\"left\" valign=\"top\">\n";

			echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
			echo "<tr>\n";
			echo "  <td align=\"left\" valign=\"top\">\n";
			echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
			echo "  </td>\n";
			echo "  <td align=\"right\" valign=\"top\">\n";
			require ("/home/colora12/public_html/tennis/includes/navtop.php");
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";


			echo "<b class=\"16px\">$statistics Statistics for {$teams[$team]}</b><br><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Option Box
	//////////////////////////////////////////////////////////////////////////////////////////

		echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bordercolor=\"#{$teamcolour[$team]}\" align=\"center\">\n";
		echo "  <tr>\n";
		echo "    <td bgcolor=\"#{$teamcolour[$team]}\" class=\"whitemain\" height=\"23\">OPTIONS</td>\n";
		echo "  </tr>\n";
		echo "  <tr>\n";
		echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\">\n";

		
		// List by season for schedule

		echo "<p class=\"10px\">Season: ";
		echo "<select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
		echo "<option value=\"\" selected>year</option>\n";

		$db->Query("SELECT la.season, se.SeasonName FROM scorecard_batting_details la INNER JOIN seasons se ON la.season = se.SeasonID WHERE se.SeasonName NOT LIKE '%KO%' GROUP BY la.season ORDER BY se.SeasonName DESC");
		for ($x=0; $x<$db->rows; $x++) {
			$db->GetRow($x);
			$db->BagAndTag();
			$sen = $db->data[SeasonName];
			$sid = $db->data[season];
		
		echo "    <option value=\"$PHP_SELF?statistics=$sen&team=$team&ccl_mode=2\" class=\"10px\">$sen</option>\n";		
		}
		echo "    <option value=\"$PHP_SELF?statistics=&team=$team&ccl_mode=2\" class=\"10px\">all</option>\n";

		echo "    </select></p>\n";

		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Detail Box
	//////////////////////////////////////////////////////////////////////////////////////////

		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"#{$teamcolour[$team]}\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"#{$teamcolour[$team]}\" class=\"whitemain\" height=\"23\">&nbsp;<b>BATTING STATISTICS</b></td>\n";
        		echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

			echo "<table width=\"100%\" cellspacing=\"1\" cellpadding=\"2\" class=\"tablehead\">\n";
			echo " <tr class=\"colhead\">\n";
			echo "  <td align=\"left\" width=\"25%\"><b>Name</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>I</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>NO</b></td>\n";
			echo "  <td align=\"right\" width=\"12%\"><b>Runs</b></td>\n";
			echo "  <td align=\"right\" width=\"9%\"><b>HS</b></td>\n";
			echo "  <td align=\"right\" width=\"12%\"><b>Ave</b></td>\n";
			echo "  <td align=\"right\" width=\"8%\"><b>100</b></td>\n";
			echo "  <td align=\"right\" width=\"6%\"><b>50</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>Ct</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>St</b></td>\n";
			echo " </tr>\n";

			$db->Query("
				SELECT 
				  g.season, n.SeasonName, 
				  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, 
				  SUM( s.notout ) AS Notouts, COUNT( s.player_id ) - SUM( s.notout ) AS Innings, SUM( s.runs ) / (COUNT( s.player_id ) - SUM( s.notout )) AS Average, 
				  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
				FROM 
				  tennis_scorecard_batting_details s
				INNER JOIN
				  tennisplayers p 
				ON 
				  s.player_id = p.PlayerID
				INNER JOIN 
				  tennis_scorecard_game_details g
				ON
				  s.game_id = g.game_id
				INNER JOIN
				  seasons n 
				ON
				  g.season = n.SeasonID			  
				WHERE 
				  p.PlayerTeam = $team AND n.SeasonName LIKE '%2005%' 
				GROUP BY 
				  s.player_id
				ORDER BY
				  Runs DESC, p.PlayerLName, p.PlayerFName
			");
			
			$db->BagAndTag();

			// instantiate new db class
			$subdb =& new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
			$subdb->SelectDB($dbcfg[db]);
		
			for ($r=0; $r<$db->rows; $r++) {
			$db->GetRow($r);			

			$playerid = $db->data[player_id];
			$init = $db->data[PlayerInitial];
			$fname = $db->data[PlayerFName];
			$lname = $db->data[PlayerLName];	
			$scinn = $db->data[Matches];
			$scrun = $db->data[Runs];
			$schig = $db->data[HS];		
			$innings = $db->data[Innings];	

			if($db->data[Notouts] != 0) {
			  $notouts = $db->data[Notouts];
			} else {
			  $notouts = "-";
			}
			
			if($db->data[Average] != "") {
			  $average = $db->data[Average];
			} else {
			  $average = "-";
			}
			
			
			

			if (!$subdb->Exists("SELECT COUNT(b.runs) AS Hundred FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.runs >= 100")){
			  $schun = "-";
			} else {
			$subdb->QueryRow("SELECT COUNT(b.runs) AS Hundred FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.runs >= 100");
			if($subdb->data[Hundred] != "0") {
			  $schun = $subdb->data[Hundred];	
			} else {
			  $schun = "-";
			}
			}

			if (!$subdb->Exists("SELECT COUNT(b.runs) AS Fifty FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND (b.runs BETWEEN 50 AND 99)")) {
			  $scfif = "-";
			} else {
			$subdb->QueryRow("SELECT COUNT(b.runs) AS Fifty FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND (b.runs BETWEEN 50 AND 99)");
			if($subdb->data[Fifty] != "0") {
			$scfif = $subdb->data[Fifty];	
			} else {
			$scfif = "-";
			}
			}


			if (!$subdb->Exists("SELECT COUNT(b.assist) AS Caught FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.assist = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 4")) {
			  $scctc = "0";
			} else {
			$subdb->QueryRow("SELECT COUNT(b.assist) AS Caught FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.assist = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 4");
			  $scctc = $subdb->data[Caught];	
			}
			
			if (!$subdb->Exists("SELECT COUNT(b.bowler) AS CandB FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.bowler = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 5")) {
			  $sccab = "0";
			} else {
			$subdb->QueryRow("SELECT COUNT(b.bowler) AS CandB FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.bowler = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 5");
			  $sccab = $subdb->data[CandB];	
			}
			
			if($scctc + $sccab != "0") {
			  $sccat = $scctc + $sccab;
			} else {
			  $sccat = "-";
			}

			if (!$subdb->Exists("SELECT COUNT(b.assist) AS Stumped FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.assist = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 10")) {
			  $scstu = "-";
			} else {
			$subdb->QueryRow("SELECT COUNT(b.assist) AS Stumped FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.assist = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 10");
			if($subdb->data[Stumped] != "0") {
			  $scstu = $subdb->data[Stumped];	
			} else {
			  $scstu = "-";
			}
			}

			if($r % 2) {
			  echo "<tr class=\"trrow1\">\n";
			} else {
			  echo "<tr class=\"trrow2\">\n";
			}
	
			echo "  <td align=\"left\" width=\"25%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
			
			echo "  </a></td>\n";
			echo "  <td align=\"right\" width=\"7%\">$scinn</td>\n";
			echo "  <td align=\"right\" width=\"7%\">$notouts</td>\n";
			echo "  <td align=\"right\" width=\"12%\">$scrun</td>\n";
			echo "  <td align=\"right\" width=\"9%\">$schig</td>\n";
			echo "  <td align=\"right\" width=\"12%\">$average</td>\n";
			echo "  <td align=\"right\" width=\"8%\">$schun</td>\n";
			echo "  <td align=\"right\" width=\"6%\">$scfif</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$sccat</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scstu</td>\n";	
			echo " </tr>\n";
			
			}
			
			echo "</table>\n";

			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";
			
// begin bowling statistics			
			
		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"#{$teamcolour[$team]}\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"#{$teamcolour[$team]}\" class=\"whitemain\" height=\"23\">&nbsp;<b>BOWLING STATISTICS</b></td>\n";
        		echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
			
			echo "<table width=\"100%\" cellspacing=\"1\" cellpadding=\"2\" class=\"tablehead\">\n";
			echo " <tr class=\"colhead\">\n";
			echo "  <td align=\"left\" width=\"25%\"><b>Name</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>O</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>M</b></td>\n";
			echo "  <td align=\"right\" width=\"8%\"><b>R</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>W</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>Ave</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>BBI</b></td>\n";
			echo "  <td align=\"right\" width=\"6%\"><b>2w</b></td>\n";
			echo "  <td align=\"right\" width=\"6%\"><b>3w</b></td>\n";
			echo "  <td align=\"right\" width=\"15%\"><b>Eco</b></td>\n";
			echo " </tr>\n";

			$db->Query("
					SELECT 
					  g.season, n.SeasonName, 
					  b.player_id, SUM(IF(INSTR(overs, '.'),((LEFT(overs, INSTR(overs, '.') - 1) * 6) + RIGHT(overs, INSTR(overs, '.') - 1)),(overs * 6))) AS Balls, SUM( b.maidens ) AS Maidens, SUM( b.runs ) AS BRuns, SUM( b.wickets ) AS Wickets, 
					  p.PlayerLName, p.PlayerFName, LEFT(p.PlayerFName,1) AS PlayerInitial
					FROM 
					  tennis_scorecard_bowling_details b 
					INNER JOIN 
					  tennisplayers p 
					ON 
					  b.player_id = p.PlayerID 
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  b.game_id = g.game_id	
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID					  
					WHERE 
					  p.PlayerTeam = $team AND n.SeasonName LIKE '%{$statistics}%'
					GROUP BY 
					  b.player_id
					ORDER BY
					  Wickets DESC, BRuns, p.PlayerLName, p.PlayerFName
			");
			
			$db->BagAndTag();

			// instantiate new db class
			$subdb =& new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
			$subdb->SelectDB($dbcfg[db]);
		
			for ($r=0; $r<$db->rows; $r++) {
			$db->GetRow($r);			

			$playerid = $db->data[player_id];
			$init = $db->data[PlayerInitial];
			$fname = $db->data[PlayerFName];
			$lname = $db->data[PlayerLName];
			$scmai = $db->data[Maidens];
			$scbru = $db->data[BRuns];
			$scwic = $db->data[Wickets];
			
			$bnum = $db->data[Balls]; 
			$bovers = Round(($bnum / 6), 2); 
			$bfloor = floor($bovers); 

			if($bovers == $bfloor + 0.17) { 
			  $scove = $bfloor + 0.1; 
			} else 
			if($bovers == $bfloor + 0.33) { 
			  $scove = $bfloor + 0.2; 
			} else 
			if($bovers == $bfloor + 0.5) { 
			  $scove = $bfloor + 0.3;        
			} else 
			if($bovers == $bfloor + 0.67) { 
			  $scove = $bfloor + 0.4;        
			} else 
			if($bovers == $bfloor + 0.83) { 
			  $scove = $bfloor + 0.5; 
			} else { 
			  $scove = $bfloor; 
			} 			
		
			$subdb->QueryRow("SELECT COUNT(b.wickets) AS twowickets FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.wickets = 2");
			if($subdb->data[twowickets] != "0") {
			  $scbfo = $subdb->data[twowickets];
			} else {
			  $scbfo = "-";
			}
		
			$subdb->QueryRow("SELECT COUNT(b.wickets) AS threewickets FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.wickets >= 3");
			if($subdb->data[threewickets] != "0") {
			  $scbfi = $subdb->data[threewickets];
			} else {
			  $scbfi = "-";
			}			
			
			
			if($scbru >= 1 && $scwic >= 1) {
			  $boavg = Number_Format(Round($scbru / $scwic, 2),2);
			} else {
			  $boavg = "-";
			}
			
			if($scbru >= 1 && $scove >= 0.1) {	
			  $boeco = Number_Format(Round($scbru / $scove, 2),2);
			} else {
			  $boeco = "-";
			}	

			$subdb->QueryRow("SELECT b.player_id, b.wickets, b.runs FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' ORDER BY b.wickets DESC, b.runs ASC LIMIT 1");
			$scbbw = $subdb->data[wickets];
			$scbbr = $subdb->data[runs];

	
			if($r % 2) {
			  echo "<tr class=\"trrow1\">\n";
			} else {
			  echo "<tr class=\"trrow2\">\n";
			}
	
			echo "  <td align=\"left\" width=\"25%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
			
			echo "  </a></td>\n";
			echo "  <td align=\"right\" width=\"7%\">$scove</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scmai</td>\n";
			echo "  <td align=\"right\" width=\"8%\">$scbru</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scwic</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$boavg</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$scbbw-$scbbr</td>\n";
			echo "  <td align=\"right\" width=\"4%\">$scbfo</td>\n";
			echo "  <td align=\"right\" width=\"4%\">$scbfi</td>\n";
			echo "  <td align=\"right\" width=\"15%\">$boeco</td>\n";	
			echo " </tr>\n";
			
			}
			
			echo "</table>\n";			

			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";
			

			echo "    </td>\n";
			echo "  </tr>\n";
			echo "</table>\n";

        }
}



function show_statistics_mostruns($db,$statistics,$sort,$sort2,$option,$team)
{
        global $dbcfg, $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

	$db->Query("SELECT * FROM seasons ORDER BY SeasonID");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$seasons[$db->data[SeasonID]] = $db->data[SeasonName];
	}
	
	$db->Query("SELECT * FROM tennisteams ORDER BY TeamName");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$teams[$db->data[TeamID]] = $db->data[TeamAbbrev];
	}
	
	
        if (!$db->Exists("
	SELECT 
	  g.season, n.SeasonName, 
	  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, 
	  SUM( s.notout ) AS Notouts, COUNT( s.player_id ) - SUM( s.notout ) AS Innings, SUM( s.runs ) / (COUNT( s.player_id ) - SUM( s.notout )) AS Average, 
	  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
	FROM 
	  tennis_scorecard_batting_details s
	INNER JOIN
	  tennisplayers p 
	ON 
	  s.player_id = p.PlayerID
	INNER JOIN
	  tennis_scorecard_game_details g
	ON
	  s.game_id = g.game_id 
	INNER JOIN
	  seasons n 
	ON
	  g.season = n.SeasonID		  
	WHERE 
	  n.SeasonName LIKE '%{$statistics}%'
	GROUP BY 
	  s.player_id        
        ")) {

	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";


	if($sort == "Average") echo "<b class=\"16px\">$statistics Batting - Highest Averages</b><br>Qualification: Top 50<br><br>\n";
	if($sort == "Runs")    echo "<b class=\"16px\">$statistics Batting - Most Runs</b><br>Qualification: Top 50<br><br>\n";
	
	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Option Box
	//////////////////////////////////////////////////////////////////////////////////////////

		echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		echo "  <tr>\n";
		echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">OPTIONS</td>\n";
		echo "  </tr>\n";
		echo "  <tr>\n";
		echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\">\n";

		
		// List by season for schedule

		echo "<p class=\"10px\">Season: ";
		echo "<select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
		echo "<option value=\"\" selected>year</option>\n";

		$db->Query("SELECT la.season, se.SeasonName FROM scorecard_batting_details la INNER JOIN seasons se ON la.season = se.SeasonID WHERE se.SeasonName NOT LIKE '%KO%' GROUP BY la.season ORDER BY se.SeasonName DESC");
		for ($x=0; $x<$db->rows; $x++) {
			$db->GetRow($x);
			$db->BagAndTag();
			$sen = $db->data[SeasonName];
			$sid = $db->data[season];
		
		if($sort == "Average") echo "    <option value=\"$PHP_SELF?option=byseason&statistics=$sen&sort=Average&sort2=Runs&ccl_mode=3\" class=\"10px\">$sen</option>\n";
		if($sort == "Runs")    echo "    <option value=\"$PHP_SELF?option=byseason&statistics=$sen&sort=Runs&sort2=Average&ccl_mode=3\" class=\"10px\">$sen</option>\n";
		}
		if($sort == "Average") echo "    <option value=\"$PHP_SELF?option=byseason&statistics=&sort=Average&sort2=Runs&ccl_mode=3\" class=\"10px\">all</option>\n";
		if($sort == "Runs")    echo "    <option value=\"$PHP_SELF?option=byseason&statistics=&sort=Runs&sort2=Average&ccl_mode=3\" class=\"10px\">all</option>\n";

		echo "    </select></p>\n";

		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table><br>\n";
		
	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$greenbdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$greenbdr\" class=\"whitemain\" height=\"23\">&nbsp;Batting Statistics</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
	
	echo " There are no statistics for this year.\n";

	echo "</td>\n";
	echo "</tr>\n";
	echo "</table><br>\n";
	
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";	
			
                return;

        } else {


		 	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
		 	echo "  <tr>\n";
		 	echo "    <td align=\"left\" valign=\"top\">\n";

			echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
			echo "<tr>\n";
			echo "  <td align=\"left\" valign=\"top\">\n";
			echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
			echo "  </td>\n";
			echo "  <td align=\"right\" valign=\"top\">\n";
			require ("/home/colora12/public_html/tennis/includes/navtop.php");
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";


	if($sort == "Average") echo "<b class=\"16px\">$statistics Batting - Highest Averages</b><br>Qualification: Top 50<br><br>\n";
	if($sort == "Runs") echo "<b class=\"16px\">$statistics Batting - Most Runs</b><br>Qualification: Top 50<br><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Option Box
	//////////////////////////////////////////////////////////////////////////////////////////

		echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		echo "  <tr>\n";
		echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">OPTIONS</td>\n";
		echo "  </tr>\n";
		echo "  <tr>\n";
		echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\">\n";

		
		// List by season for schedule

		echo "<p class=\"10px\">Season: ";
		echo "<select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
		echo "<option value=\"\" selected>year</option>\n";

		$db->Query("SELECT la.season, se.SeasonName FROM scorecard_batting_details la INNER JOIN seasons se ON la.season = se.SeasonID WHERE se.SeasonName NOT LIKE '%KO%' GROUP BY la.season ORDER BY se.SeasonName DESC");
		for ($x=0; $x<$db->rows; $x++) {
			$db->GetRow($x);
			$db->BagAndTag();
			$sen = $db->data[SeasonName];
			$sid = $db->data[season];
		
		if($sort == "Average") echo "    <option value=\"$PHP_SELF?option=byseason&statistics=$sen&sort=Average&sort2=Runs&ccl_mode=3\" class=\"10px\">$sen</option>\n";
		if($sort == "Runs")    echo "    <option value=\"$PHP_SELF?option=byseason&statistics=$sen&sort=Runs&sort2=Average&ccl_mode=3\" class=\"10px\">$sen</option>\n";
		}
		if($sort == "Average") echo "    <option value=\"$PHP_SELF?option=byseason&statistics=&sort=Average&sort2=Runs&ccl_mode=3\" class=\"10px\">all</option>\n";
		if($sort == "Runs")    echo "    <option value=\"$PHP_SELF?option=byseason&statistics=&sort=Runs&sort2=Average&ccl_mode=3\" class=\"10px\">all</option>\n";

		echo "    </select></p>\n";

		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table><br>\n";
		
// begin batting statistics

		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$greenbdr\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"$greenbdr\" class=\"whitemain\" height=\"23\">&nbsp;Batting Statistics</td>\n";
        		echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

			echo "<table width=\"100%\" cellspacing=\"1\" cellpadding=\"2\" class=\"tablehead\">\n";
			echo " <tr class=\"colhead\">\n";
			echo "  <td align=\"left\" width=\"2%\">&nbsp;</td>\n";
			echo "  <td align=\"left\" width=\"24%\"><b>Name</b></td>\n";
			echo "  <td align=\"right\" width=\"6%\"><b>I</b></td>\n";
			echo "  <td align=\"right\" width=\"6%\"><b>NO</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>Runs</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>HS</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>Ave</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>100</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>50</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>Ct</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>St</b></td>\n";
			echo "  <td align=\"right\" width=\"15%\"><b>Team</b></td>\n";
			echo " </tr>\n";

			$db->Query("
					SELECT 
					  g.season, n.SeasonName, 
					  t.TeamAbbrev, 
					  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, 
					  SUM( s.notout ) AS Notouts, COUNT( s.player_id ) - SUM( s.notout ) AS Innings, SUM( s.runs ) / (COUNT( s.player_id ) - SUM( s.notout )) AS Average, 
					  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
					FROM 
					  tennis_scorecard_batting_details s
					INNER JOIN
					  tennisplayers p 
					ON 
					  s.player_id = p.PlayerID
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  s.game_id = g.game_id
					INNER JOIN
					  tennisteams t
					ON 
					  p.PlayerTeam = t.TeamID
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID		  
					WHERE 
					  n.SeasonName LIKE '%{$statistics}%' 
					GROUP BY 
					  s.player_id
					ORDER BY
					  $sort DESC
					LIMIT 50
			");
			
			$db->BagAndTag();

			// instantiate new db class
			$subdb =& new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
			$subdb->SelectDB($dbcfg[db]);
		
			for ($r=0; $r<$db->rows; $r++) {
			$db->GetRow($r);			

			$playerid = $db->data[player_id];
			$init = $db->data[PlayerInitial];
			$fname = $db->data[PlayerFName];
			$lname = $db->data[PlayerLName];	
			$scinn = $db->data[Matches];
			$scrun = $db->data[Runs];
			$schig = $db->data[HS];	
			$teama = $db->data[TeamAbbrev];
			$innings = $db->data[Innings];

			if($db->data[Notouts] != 0) {
			  $notouts = $db->data[Notouts];
			} else {
			  $notouts = "-";
			}

			if($db->data[Average] != "") {
			  $average = $db->data[Average];
			} else {
			  $average = "-";
			}
			
			$subdb->QueryRow("SELECT COUNT(b.runs) AS Hundred FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND b.runs >= 100");
			if($subdb->data[Hundred] != "0") {
			  $schun = $subdb->data[Hundred];	
			} else {
			  $schun = "-";
			}

			$subdb->QueryRow("SELECT COUNT(b.runs) AS Fifty FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND (b.runs BETWEEN 50 AND 99) ");
			if($subdb->data[Fifty] != "0") {
			$scfif = $subdb->data[Fifty];	
			} else {
			$scfif = "-";
			}

			$subdb->QueryRow("SELECT COUNT(b.assist) AS Caught FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.assist = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 4");
			  $scctc = $subdb->data[Caught];	

			$subdb->QueryRow("SELECT COUNT(b.bowler) AS CandB FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.bowler = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 5");
			  $sccab = $subdb->data[CandB];	

			if($scctc + $sccab != "0") {
			  $sccat = $scctc + $sccab;
			} else {
			  $sccat = "-";
			}
	

			$subdb->QueryRow("SELECT COUNT(b.assist) AS Stumped FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.assist = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 10");
			if($subdb->data[Stumped] != "0") {
			  $scstu = $subdb->data[Stumped];	
			} else {
			  $scstu = "-";
			}
	
			if($r % 2) {
			  echo "<tr class=\"trrow1\">\n";
			} else {
			  echo "<tr class=\"trrow2\">\n";
			}
	
			echo "  <td align=\"left\" width=\"2%\">";
			echo ($r+1);
			echo "  </td>\n";
			echo "  <td align=\"left\" width=\"24%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
			
			echo "  </a></td>\n";
			echo "  <td align=\"right\" width=\"6%\">$scinn</td>\n";
			echo "  <td align=\"right\" width=\"6%\">$notouts</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$scrun</td>\n";
			echo "  <td align=\"right\" width=\"7%\">$schig</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$average</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$schun</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scfif</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$sccat</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scstu</td>\n";
			echo "  <td align=\"right\" width=\"15%\">$teama</td>\n";
			echo " </tr>\n";
			
			}
			
			echo "</table>\n";

			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";
			

			echo "    </td>\n";
			echo "  </tr>\n";
			echo "</table>\n";

        }
}




function show_statistics_bighits($db,$statistics,$sort)
{
        global $dbcfg, $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

	$db->Query("SELECT * FROM seasons ORDER BY SeasonID");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$seasons[$db->data[SeasonID]] = $db->data[SeasonName];
	}
	
        if (!$db->Exists("
	SELECT 
	  g.season, n.SeasonName, 
	  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, 
	  SUM( s.notout ) AS Notouts, COUNT( s.player_id ) - SUM( s.notout ) AS Innings, SUM( s.runs ) / (COUNT( s.player_id ) - SUM( s.notout )) AS Average, 
	  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
	FROM 
	  tennis_scorecard_batting_details s
	INNER JOIN
	  tennisplayers p 
	ON 
	  s.player_id = p.PlayerID
	INNER JOIN
	  tennis_scorecard_game_details g
	ON
	  s.game_id = g.game_id 
	INNER JOIN
	  seasons n 
	ON
	  g.season = n.SeasonID		  
	WHERE 
	  n.SeasonName LIKE '%{$statistics}%'
	GROUP BY 
	  s.player_id        
        ")) {

	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";


	if($sort == "sixes") echo "<b class=\"16px\">$statistics Batting - Most Sixes</b><br><br>\n";
	if($sort == "fours") echo "<b class=\"16px\">$statistics Batting - Most Fours</b><br><br>\n";

	//////////////////////////////////////////////////////////////////////////////////////////
	// Statistics Option Box
	//////////////////////////////////////////////////////////////////////////////////////////

		echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"3\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		echo "  <tr>\n";
		echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">OPTIONS</td>\n";
		echo "  </tr>\n";
		echo "  <tr>\n";
		echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\">\n";

		
		// List by season for schedule

		echo "<p class=\"10px\">Season: ";
		echo "<select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
		echo "<option value=\"\" selected>year</option>\n";

		$db->Query("SELECT la.season, se.SeasonName FROM scorecard_batting_details la INNER JOIN seasons se ON la.season = se.SeasonID WHERE se.SeasonName NOT LIKE '%KO%' GROUP BY la.season ORDER BY se.SeasonName DESC");
		for ($x=0; $x<$db->rows; $x++) {
			$db->GetRow($x);
			$db->BagAndTag();
			$sen = $db->data[SeasonName];
			$sid = $db->data[season];
		
		if($sort == "sixes") echo "    <option value=\"$PHP_SELF?option=byseason&statistics=$sen&sort=Average&sort2=Runs&ccl_mode=3\" class=\"10px\">$sen</option>\n";
		if($sort == "fours") echo "    <option value=\"$PHP_SELF?option=byseason&statistics=$sen&sort=Runs&sort2=Average&ccl_mode=3\" class=\"10px\">$sen</option>\n";
		}
		if($sort == "sixes") echo "    <option value=\"$PHP_SELF?option=byseason&statistics=&sort=Average&sort2=Runs&ccl_mode=3\" class=\"10px\">all</option>\n";
		if($sort == "fours") echo "    <option value=\"$PHP_SELF?option=byseason&statistics=&sort=Runs&sort2=Average&ccl_mode=3\" class=\"10px\">all</option>\n";

		echo "    </select></p>\n";

		echo "    </td>\n";
		echo "  </tr>\n";
		echo "</table><br>\n";
		
	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Batting Statistics</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
	
	echo " There are no statistics for this year.\n";

	echo "</td>\n";
	echo "</tr>\n";
	echo "</table><br>\n";

// begin season selection

	if ($db->Exists("SELECT * FROM seasons")) {
	$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

	echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td>\n";

	echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
	echo "  <option>select another season</option>\n";
	echo "  <option>=====================</option>\n";
	for ($x=0; $x<$db->rows; $x++) {
		$db->GetRow($x);
		$db->BagAndTag();
		$id = $db->data[SeasonID];
		$seasonname = $db->data[SeasonName];
		// output article

	echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
	}
}
	echo "</select></p>\n";
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";

			
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";
	
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";	
			
                return;

        } else {


		 	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
		 	echo "  <tr>\n";
		 	echo "    <td align=\"left\" valign=\"top\">\n";

			echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
			echo "<tr>\n";
			echo "  <td align=\"left\" valign=\"top\">\n";
			echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
			echo "  </td>\n";
			echo "  <td align=\"right\" valign=\"top\">\n";
			require ("/home/colora12/public_html/tennis/includes/navtop.php");
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";


	if($sort == "sixes") echo "<b class=\"16px\">$statistics Batting - Most Sixes</b><br><br>\n";
	if($sort == "fours") echo "<b class=\"16px\">$statistics Batting - Most Fours</b><br><br>\n";

// begin batting statistics

		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Batting Statistics</td>\n";
        		echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

			echo "<table width=\"100%\" cellspacing=\"0\" cellpadding=\"2\">\n";
			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"2%\">&nbsp;</td>\n";
			echo "  <td align=\"left\" width=\"24%\"><b>Name</b></td>\n";
			echo "  <td align=\"right\" width=\"6%\"><b>I</b></td>\n";
			echo "  <td align=\"right\" width=\"6%\"><b>NO</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>Runs</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>HS</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>Ave</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>100</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>50</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>4s</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>6s</b></td>\n";
			echo "  <td align=\"right\" width=\"15%\"><b>Team</b></td>\n";
			echo " </tr>\n";

			if($sort == "sixes") {
			
			$db->Query("
					SELECT 
					  g.season, n.SeasonName, 
					  t.TeamAbbrev, 
					  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, SUM( s.fours) AS Fours,  SUM( s.sixes ) AS Sixes, 
					  SUM( s.notout ) AS Notouts, COUNT( s.player_id ) - SUM( s.notout ) AS Innings, SUM( s.runs ) / (COUNT( s.player_id ) - SUM( s.notout )) AS Average, 
					  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
					FROM 
					  tennis_scorecard_batting_details s
					INNER JOIN
					  tennisplayers p 
					ON 
					  s.player_id = p.PlayerID
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  s.game_id = g.game_id
					INNER JOIN
					  tennisteams t
					ON 
					  p.PlayerTeam = t.TeamID
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID		  
					WHERE 
					  n.SeasonName LIKE '%{$statistics}%'
					GROUP BY 
					  s.player_id
					ORDER BY
					  $sort DESC
			");
			
			} else {
			
			$db->Query("
					SELECT 
					  g.season, n.SeasonName, 
					  t.TeamAbbrev, 
					  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, SUM( s.fours) AS Fours,  SUM( s.sixes ) AS Sixes, 
					  SUM( s.notout ) AS Notouts, COUNT( s.player_id ) - SUM( s.notout ) AS Innings, SUM( s.runs ) / (COUNT( s.player_id ) - SUM( s.notout )) AS Average, 
					  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
					FROM 
					  tennis_scorecard_batting_details s
					INNER JOIN
					  tennisplayers p 
					ON 
					  s.player_id = p.PlayerID
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  s.game_id = g.game_id
					INNER JOIN
					  tennisteams t
					ON 
					  p.PlayerTeam = t.TeamID
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID		  
					WHERE 
					  n.SeasonName LIKE '%{$statistics}%'
					GROUP BY 
					  s.player_id
					ORDER BY
					  $sort DESC
			");	
			
			}
			
			$db->BagAndTag();

			// instantiate new db class
			$subdb =& new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
			$subdb->SelectDB($dbcfg[db]);
		
			for ($r=0; $r<$db->rows; $r++) {
			$db->GetRow($r);			

			$playerid = $db->data[player_id];
			$init = $db->data[PlayerInitial];
			$fname = $db->data[PlayerFName];
			$lname = $db->data[PlayerLName];	
			$scinn = $db->data[Matches];
			$scrun = $db->data[Runs];
			$schig = $db->data[HS];		
			$teama = $db->data[TeamAbbrev];
			$innings = $db->data[Innings];

			if($db->data[Notouts] != 0) {
			  $notouts = $db->data[Notouts];
			} else {
			  $notouts = "-";
			}

			if($db->data[Average] != "") {
			  $average = $db->data[Average];
			} else {
			  $average = "-";
			}
			
			if($db->data[Fours] != 0) {
			  $fours = $db->data[Fours];
			} else {
			  $fours = "-";
			}
			
			if($db->data[Sixes] != 0) {
			  $sixes = $db->data[Sixes];
			} else {
			  $sixes = "-";
			}			
			
			$subdb->QueryRow("SELECT COUNT(b.runs) AS Hundred FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND b.runs >= 100");
			if($subdb->data[Hundred] != "0") {
			  $schun = $subdb->data[Hundred];	
			} else {
			  $schun = "-";
			}

			$subdb->QueryRow("SELECT COUNT(b.runs) AS Fifty FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND (b.runs BETWEEN 50 AND 99) ");
			if($subdb->data[Fifty] != "0") {
			$scfif = $subdb->data[Fifty];	
			} else {
			$scfif = "-";
			}

			$subdb->QueryRow("SELECT COUNT(b.assist) AS Caught FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.assist = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 4");
			  $scctc = $subdb->data[Caught];	

			$subdb->QueryRow("SELECT COUNT(b.bowler) AS CandB FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.bowler = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 5");
			  $sccab = $subdb->data[CandB];	

			if($scctc + $sccab != "0") {
			  $sccat = $scctc + $sccab;
			} else {
			  $sccat = "-";
			}
	

			$subdb->QueryRow("SELECT COUNT(b.assist) AS Stumped FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.assist = $playerid  AND s.SeasonName LIKE '%{$statistics}%' AND b.how_out = 10");
			if($subdb->data[Stumped] != "0") {
			  $scstu = $subdb->data[Stumped];	
			} else {
			  $scstu = "-";
			}


			
			if($sort == "sixes" && $sixes != "-") {
			
			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"2%\">";
			echo ($r+1);
			echo "  </td>\n";
			echo "  <td align=\"left\" width=\"24%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
			
			
			
			echo "  </a></td>\n";
			echo "  <td align=\"right\" width=\"6%\">$scinn</td>\n";
			echo "  <td align=\"right\" width=\"6%\">$notouts</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$scrun</td>\n";
			echo "  <td align=\"right\" width=\"7%\">$schig</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$average</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$schun</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scfif</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$fours</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$sixes</td>\n";
			echo "  <td align=\"right\" width=\"15%\">$teama</td>\n";
			echo " </tr>\n";
			
			} else if ($sort == "fours" && $fours != "-") {

			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"2%\">";
			echo ($r+1);
			echo "  </td>\n";
			echo "  <td align=\"left\" width=\"24%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
						
			echo "  </a></td>\n";
			echo "  <td align=\"right\" width=\"6%\">$scinn</td>\n";
			echo "  <td align=\"right\" width=\"6%\">$notouts</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$scrun</td>\n";
			echo "  <td align=\"right\" width=\"7%\">$schig</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$average</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$schun</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scfif</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$fours</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$sixes</td>\n";
			echo "  <td align=\"right\" width=\"15%\">$teama</td>\n";
			echo " </tr>\n";
			
			} else {
			
			echo "";
			
			}
			
			}
			
			echo "</table><br>\n";

			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";
			
			
// begin season selection

			if ($db->Exists("SELECT * FROM seasons")) {
			$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

 		        echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
 		        echo "  <tr>\n";
 		        echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
         		echo "  </tr>\n";
         		echo "  <tr>\n";
 			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

 			echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
 			echo "  <tr>\n";
			echo "    <td>\n";

 			echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
			echo "  <option>select another season</option>\n";
			echo "  <option>=====================</option>\n";
			for ($x=0; $x<$db->rows; $x++) {
				$db->GetRow($x);
				$db->BagAndTag();
				$id = $db->data[SeasonID];
				$seasonname = $db->data[SeasonName];
				// output article

			echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
			}
		}
			echo "</select></p>\n";
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "    </td>\n";
			echo "  </tr>\n";
			echo "</table>\n";

        }
}




function show_statistics_bowling($db,$statistics,$sort,$direction)
{
        global $dbcfg, $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

	$db->Query("SELECT * FROM seasons ORDER BY SeasonID");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$seasons[$db->data[SeasonID]] = $db->data[SeasonName];
	}
	
	
        if (!$db->Exists("
	SELECT 
	  g.season, n.SeasonName, 
	  COUNT( s.player_id ) AS Matches,  
	  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
	FROM 
	  tennis_scorecard_bowling_details s
	INNER JOIN
	  tennisplayers p 
	ON 
	  s.player_id = p.PlayerID
	INNER JOIN
	  tennis_scorecard_game_details g
	ON
	  s.game_id = g.game_id
	INNER JOIN
	  seasons n 
	ON
	  g.season = n.SeasonID		  
	WHERE 
	  n.SeasonName LIKE '%{$statistics}%'
	GROUP BY 
	  s.player_id        
        ")) {

        
        
	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";

	if($sort == "Wickets") 	echo "<b class=\"16px\">$statistics Bowling - Most Wickets</b><br>Qualification: 3 wickets<br>\n";
	if($sort == "Balls") 	echo "<b class=\"16px\">$statistics Bowling - Workhorses</b><br>Qualification: 5 overs<br>\n";
	if($sort == "Average") 	echo "<b class=\"16px\">$statistics Bowling - Best Averages</b><br>Qualification: 3 wickets<br>\n";

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Bowling Statistics</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
	
	echo " There are no statistics for this year.\n";

	echo "</td>\n";
	echo "</tr>\n";
	echo "</table><br>\n";

// begin season selection

	if ($db->Exists("SELECT * FROM seasons")) {
	$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

	echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td>\n";

	echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
	echo "  <option>select another season</option>\n";
	echo "  <option>=====================</option>\n";
	for ($x=0; $x<$db->rows; $x++) {
		$db->GetRow($x);
		$db->BagAndTag();
		$id = $db->data[SeasonID];
		$seasonname = $db->data[SeasonName];
		// output article

	echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
	}
}
	echo "</select></p>\n";
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";

			
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";
	
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";	
			
                return;
                
        } else {        
                
	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";


	if($sort == "Wickets") 	echo "<b class=\"16px\">$statistics Bowling - Most Wickets</b><br>Qualification: 3 wickets<br><br>\n";
	if($sort == "Balls") 	echo "<b class=\"16px\">$statistics Bowling - Workhorses</b><br>Qualification: 5 overs<br><br>\n";
	if($sort == "Average") 	echo "<b class=\"16px\">$statistics Bowling - Best Averages</b><br>Qualification: 3 wickets<br><br>\n";

			
// begin bowling statistics			
			
		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Bowling Statistics</td>\n";
        		echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
			
			echo "<table width=\"100%\" cellspacing=\"0\" cellpadding=\"2\">\n";
			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"2%\">&nbsp;</td>\n";
			echo "  <td align=\"left\" width=\"23%\"><b>Name</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>O</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>M</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>R</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>W</b></td>\n";
			echo "  <td align=\"right\" width=\"9%\"><b>Ave</b></td>\n";
			echo "  <td align=\"right\" width=\"9%\"><b>BBI</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>3w</b></td>\n";
			echo "  <td align=\"right\" width=\"8%\"><b>Eco</b></td>\n";
			echo "  <td align=\"right\" width=\"20%\"><b>Team</b></td>\n";
			echo " </tr>\n";

			if($sort == "Average") {

			$db->Query("
					SELECT 
					  g.season, n.SeasonName, 
					  t.TeamAbbrev, 
					  b.player_id, SUM(IF(INSTR(overs, '.'),((LEFT(overs, INSTR(overs, '.') - 1) * 6) + RIGHT(overs, INSTR(overs, '.') - 1)),(overs * 6))) AS Balls, SUM( b.maidens ) AS Maidens, SUM( b.runs ) AS BRuns, SUM( b.wickets ) AS Wickets, 
					  SUM( b.runs ) / SUM( b.wickets ) AS Average, 
					  p.PlayerLName, p.PlayerFName, LEFT(p.PlayerFName,1) AS PlayerInitial
					FROM 
					  tennis_scorecard_bowling_details b 
					INNER JOIN 
					  tennisplayers p 
					ON 
					  b.player_id = p.PlayerID 
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  b.game_id = g.game_id	
					INNER JOIN
					  tennisteams t 
					ON
					  p.PlayerTeam = t.TeamID
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID		  
					WHERE 
					  n.SeasonName LIKE '%{$statistics}%'
					GROUP BY 
					  b.player_id
					ORDER BY
					  $sort $direction
			");
			
			} else {
			
			$db->Query("
					SELECT 
					  g.season, n.SeasonName, 
					  t.TeamAbbrev, 
					  b.player_id, SUM(IF(INSTR(overs, '.'),((LEFT(overs, INSTR(overs, '.') - 1) * 6) + RIGHT(overs, INSTR(overs, '.') - 1)),(overs * 6))) AS Balls, SUM( b.maidens ) AS Maidens, SUM( b.runs ) AS BRuns, SUM( b.wickets ) AS Wickets, 
					  SUM( b.runs ) / SUM( b.wickets ) AS Average, 
					  p.PlayerLName, p.PlayerFName, LEFT(p.PlayerFName,1) AS PlayerInitial
					FROM 
					  tennis_scorecard_bowling_details b 
					INNER JOIN 
					  tennisplayers p 
					ON 
					  b.player_id = p.PlayerID 
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  b.game_id = g.game_id	
					INNER JOIN
					  tennisteams t 
					ON
					  p.PlayerTeam = t.TeamID
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID		  
					WHERE 
					  n.SeasonName LIKE '%{$statistics}%'
					GROUP BY 
					  b.player_id
					ORDER BY
					  $sort $direction, BRuns ASC
			");
			
			}
			
			$db->BagAndTag();

			// instantiate new db class
			$subdb =& new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
			$subdb->SelectDB($dbcfg[db]);
		
			
			for ($r=0; $r<$db->rows; $r++) {
			$db->GetRow($r);			

			$playerid = $db->data[player_id];
			$init = $db->data[PlayerInitial];
			$fname = $db->data[PlayerFName];
			$lname = $db->data[PlayerLName];
			$scmai = $db->data[Maidens];
			$scbru = $db->data[BRuns];
			$scwic = $db->data[Wickets];
			$teama = $db->data[TeamAbbrev];
			
			if($db->data[Average] != "") {
			  $average = $db->data[Average];
			} else {
			  $average = "-";
			}
			
			$bnum = $db->data[Balls]; 
			$bovers = Round(($bnum / 6), 2); 
			$bfloor = floor($bovers); 

			if($bovers == $bfloor + 0.17) { 
			  $scove = $bfloor + 0.1; 
			} else 
			if($bovers == $bfloor + 0.33) { 
			  $scove = $bfloor + 0.2; 
			} else 
			if($bovers == $bfloor + 0.5) { 
			  $scove = $bfloor + 0.3;        
			} else 
			if($bovers == $bfloor + 0.67) { 
			  $scove = $bfloor + 0.4;        
			} else 
			if($bovers == $bfloor + 0.83) { 
			  $scove = $bfloor + 0.5; 
			} else { 
			  $scove = $bfloor; 
			}     			
		
			$subdb->QueryRow("SELECT COUNT(b.wickets) AS fourwickets FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.wickets >= 3");
			if($subdb->data[fourwickets] != "0") {
			  $scbfo = $subdb->data[fourwickets];
			} else {
			  $scbfo = "-";
			}
		
			$subdb->QueryRow("SELECT COUNT(b.wickets) AS fivewickets FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' AND b.wickets >= 5");
			if($subdb->data[fivewickets] != "0") {
			  $scbfi = $subdb->data[fivewickets];
			} else {
			  $scbfi = "-";
			}			
			
			
			if($scbru >= 1 && $scove >= 0.1) {	
			  $boeco = Number_Format(Round($scbru / $scove, 2),2);
			} else {
			  $boeco = "-";
			}	

			$subdb->QueryRow("SELECT b.player_id, b.wickets, b.runs FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' ORDER BY b.wickets DESC, b.runs ASC LIMIT 1");
			$scbbw = $subdb->data[wickets];
			$scbbr = $subdb->data[runs];

	
			// dont allow those who haven't taken wickets or have no average
				
			if($scwic >= 3) {
			
			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"2%\">";
			echo ($r+1);
			echo "  </td>\n";			
			echo "  <td align=\"left\" width=\"23%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
			
			echo "  </a></td>\n";
			echo "  <td align=\"right\" width=\"7%\">$scove</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scmai</td>\n";
			echo "  <td align=\"right\" width=\"7%\">$scbru</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scwic</td>\n";
			echo "  <td align=\"right\" width=\"9%\">$average</td>\n";
			echo "  <td align=\"right\" width=\"9%\">$scbbw-$scbbr</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scbfo</td>\n";
			echo "  <td align=\"right\" width=\"8%\">$boeco</td>\n";
			echo "  <td align=\"right\" width=\"20%\">$teama</td>\n";
			echo " </tr>\n";
			
			} else {
			}
			
			}
			
			echo "</table><br>\n";			

			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";
			
			
// begin season selection

			if ($db->Exists("SELECT * FROM seasons")) {
			$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

 		        echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
 		        echo "  <tr>\n";
 		        echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
         		echo "  </tr>\n";
         		echo "  <tr>\n";
 			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

 			echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
 			echo "  <tr>\n";
			echo "    <td>\n";

 			echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
			echo "  <option>select another season</option>\n";
			echo "  <option>=====================</option>\n";
			for ($x=0; $x<$db->rows; $x++) {
				$db->GetRow($x);
				$db->BagAndTag();
				$id = $db->data[SeasonID];
				$seasonname = $db->data[SeasonName];
				// output article

			echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
			}
		}
			echo "</select></p>\n";
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "    </td>\n";
			echo "  </tr>\n";
			echo "</table>\n";

        }
}


function show_statistics_bestbowling($db,$statistics)
{
        global $dbcfg, $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

	$db->Query("SELECT * FROM seasons ORDER BY SeasonID");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$seasons[$db->data[SeasonID]] = $db->data[SeasonName];
	}
	
	
        if (!$db->Exists("
	SELECT 
	  g.season, n.SeasonName, 
	  COUNT( s.player_id ) AS Matches,  
	  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
	FROM 
	  tennis_scorecard_bowling_details s
	INNER JOIN
	  tennisplayers p 
	ON 
	  s.player_id = p.PlayerID
	INNER JOIN
	  tennis_scorecard_game_details g
	ON
	  s.game_id = g.game_id
	INNER JOIN
	  seasons n 
	ON
	  g.season = n.SeasonID		  
	WHERE 
	  n.SeasonName LIKE '%{$statistics}%' 
	GROUP BY 
	  s.player_id        
        ")) {

        
        
	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";

	echo "<b class=\"16px\">$statistics Bowling - Best Innings Bowling</b><br>\n";

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Bowling Statistics</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
	
	echo " There are no statistics for this year.\n";

	echo "</td>\n";
	echo "</tr>\n";
	echo "</table><br>\n";

// begin season selection

	if ($db->Exists("SELECT * FROM seasons")) {
	$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

	echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td>\n";

	echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
	echo "  <option>select another season</option>\n";
	echo "  <option>=====================</option>\n";
	for ($x=0; $x<$db->rows; $x++) {
		$db->GetRow($x);
		$db->BagAndTag();
		$id = $db->data[SeasonID];
		$seasonname = $db->data[SeasonName];
		// output article

	echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
	}
}
	echo "</select></p>\n";
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";

			
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";
	
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";	
			
                return;
                
        } else {        
                
	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";


	echo "<b class=\"16px\">$statistics Bowling - Best Innings Bowling</b><br>Qualification: 2 wickets<br><br>\n";

			
// begin bowling statistics			
			
		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Bowling Statistics</td>\n";
        		echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
			
			echo "<table width=\"100%\" cellspacing=\"0\" cellpadding=\"2\">\n";

			$db->Query("
					SELECT 
					  g.season, n.SeasonName, g.game_id, g.game_date, g.awayteam, g.hometeam, 
					  r.GroundName AS Ground, 
					  a.TeamAbbrev AS AwayAbbrev, h.TeamAbbrev AS HomeAbbrev, 
					  b.player_id, b.runs AS BRuns, b.wickets AS Wickets, 
					  p.PlayerLName, p.PlayerFName, LEFT(p.PlayerFName,1) AS PlayerInitial
					FROM 
					  tennis_scorecard_bowling_details b 
					INNER JOIN 
					  tennisplayers p 
					ON 
					  b.player_id = p.PlayerID 
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  b.game_id = g.game_id	
					INNER JOIN 
					  tennisteams a 
					ON
					  g.awayteam = a.TeamID
					INNER JOIN
					  tennisteams h
					ON
					  g.hometeam = h.TeamID
					INNER JOIN
					  grounds r
					ON
					  g.ground_id = r.GroundID
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID		  
					WHERE 
					  n.SeasonName LIKE '%{$statistics}%' AND Wickets >= 2					  
					ORDER BY
					  Wickets DESC, Runs ASC
			");
			
			$db->BagAndTag();

			// instantiate new db class
			$subdb =& new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
			$subdb->SelectDB($dbcfg[db]);
		
			for ($r=0; $r<$db->rows; $r++) {
			$db->GetRow($r);			

			$playerid = $db->data[player_id];
			$init = $db->data[PlayerInitial];
			$fname = $db->data[PlayerFName];
			$lname = $db->data[PlayerLName];
			$scbru = $db->data[BRuns];
			$scwic = $db->data[Wickets];
			$awayt = $db->data[AwayAbbrev];
			$homet = $db->data[HomeAbbrev];
			$groun = $db->data[Ground];
			$gamed = $db->data[game_date];
			$gamei = $db->data[game_id];
			


	
			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"7%\">$scwic/$scbru</td>\n";
			
			echo "  <td align=\"left\" width=\"25%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
			
			echo "  </a></td>\n";	
			echo "  <td align=\"left\" width=\"63%\">$awayt v $homet at $groun, $gamed [<a href=\"/scorecardfull.php?game_id=$gamei&ccl_mode=4\" class=\"scorecard\">$gamei</a>]</td>\n";
			echo " </tr>\n";
			
			}
			
			echo "</table><br>\n";			

			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";
			
			
// begin season selection

			if ($db->Exists("SELECT * FROM seasons")) {
			$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

 		        echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
 		        echo "  <tr>\n";
 		        echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
         		echo "  </tr>\n";
         		echo "  <tr>\n";
 			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

 			echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
 			echo "  <tr>\n";
			echo "    <td>\n";

 			echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
			echo "  <option>select another season</option>\n";
			echo "  <option>=====================</option>\n";
			for ($x=0; $x<$db->rows; $x++) {
				$db->GetRow($x);
				$db->BagAndTag();
				$id = $db->data[SeasonID];
				$seasonname = $db->data[SeasonName];
				// output article

			echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
			}
		}
			echo "</select></p>\n";
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "    </td>\n";
			echo "  </tr>\n";
			echo "</table>\n";

        }
}


function show_statistics_bestinnings($db,$statistics)
{
        global $dbcfg, $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

	$db->Query("SELECT * FROM seasons ORDER BY SeasonID");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$seasons[$db->data[SeasonID]] = $db->data[SeasonName];
	}
	
	
        if (!$db->Exists("
	SELECT 
	  g.season, n.SeasonName, 
	  COUNT( s.player_id ) AS Matches,  
	  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
	FROM 
	  tennis_scorecard_batting_details s
	INNER JOIN
	  tennisplayers p 
	ON 
	  s.player_id = p.PlayerID
	INNER JOIN
	  tennis_scorecard_game_details g
	ON
	  s.game_id = g.game_id
	INNER JOIN
	  seasons n 
	ON
	  g.season = n.SeasonID		  
	WHERE 
	  n.SeasonName LIKE '%{$statistics}%' 
	GROUP BY 
	  s.player_id        
        ")) {

        
        
	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";

	echo "<b class=\"16px\">$statistics Batting - Highest Innings Scores</b><br>Qualification: Top 50<br>\n";

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Batting Statistics</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
	
	echo " There are no statistics for this year.\n";

	echo "</td>\n";
	echo "</tr>\n";
	echo "</table><br>\n";

// begin season selection

	if ($db->Exists("SELECT * FROM seasons")) {
	$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

	echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td>\n";

	echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
	echo "  <option>select another season</option>\n";
	echo "  <option>=====================</option>\n";
	for ($x=0; $x<$db->rows; $x++) {
		$db->GetRow($x);
		$db->BagAndTag();
		$id = $db->data[SeasonID];
		$seasonname = $db->data[SeasonName];
		// output article

	echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
	}
}
	echo "</select></p>\n";
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";

			
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";
	
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";	
			
                return;
                
        } else {        
                
	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";


	echo "<b class=\"16px\">$statistics Batting - Highest Innings Scores</b><br>Qualification: Top 50<br><br>\n";

			
// begin bowling statistics			
			
		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Bowling Statistics</td>\n";
        		echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
			
			echo "<table width=\"100%\" cellspacing=\"0\" cellpadding=\"2\">\n";

			$db->Query("
					SELECT 
					  g.season, n.SeasonName, g.game_id, g.game_date, g.awayteam, g.hometeam, 
					  r.GroundName AS Ground, 
					  a.TeamAbbrev AS AwayAbbrev, h.TeamAbbrev AS HomeAbbrev, 
					  b.player_id, b.runs AS Runs,  
					  p.PlayerLName, p.PlayerFName, LEFT(p.PlayerFName,1) AS PlayerInitial
					FROM 
					  tennis_scorecard_batting_details b 
					INNER JOIN 
					  tennisplayers p 
					ON 
					  b.player_id = p.PlayerID 
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  b.game_id = g.game_id	
					INNER JOIN 
					  tennisteams a 
					ON
					  g.awayteam = a.TeamID
					INNER JOIN
					  tennisteams h
					ON
					  g.hometeam = h.TeamID
					INNER JOIN
					  grounds r
					ON
					  g.ground_id = r.GroundID
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID		  
					WHERE 
					  n.SeasonName LIKE '%{$statistics}%'					  
					ORDER BY
					  Runs DESC
					LIMIT 50
			");
			
			$db->BagAndTag();

			// instantiate new db class
			$subdb =& new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
			$subdb->SelectDB($dbcfg[db]);
		
			for ($r=0; $r<$db->rows; $r++) {
			$db->GetRow($r);			

			$playerid = $db->data[player_id];
			$init = $db->data[PlayerInitial];
			$fname = $db->data[PlayerFName];
			$lname = $db->data[PlayerLName];
			$bruns = $db->data[Runs];
			$awayt = $db->data[AwayAbbrev];
			$homet = $db->data[HomeAbbrev];
			$groun = $db->data[Ground];
			$gamed = $db->data[game_date];
			$gamei = $db->data[game_id];
			


	
			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"7%\">$bruns</td>\n";
			
			echo "  <td align=\"left\" width=\"25%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
			
			echo "  </a></td>\n";	
			echo "  <td align=\"left\" width=\"63%\">$awayt v $homet at $groun, $gamed [<a href=\"/scorecardfull.php?game_id=$gamei&ccl_mode=4\" class=\"scorecard\">$gamei</a>]</td>\n";
			echo " </tr>\n";
			
			}
			
			echo "</table><br>\n";			

			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";
			
			
// begin season selection

			if ($db->Exists("SELECT * FROM seasons")) {
			$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

 		        echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
 		        echo "  <tr>\n";
 		        echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
         		echo "  </tr>\n";
         		echo "  <tr>\n";
 			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

 			echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
 			echo "  <tr>\n";
			echo "    <td>\n";

 			echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
			echo "  <option>select another season</option>\n";
			echo "  <option>=====================</option>\n";
			for ($x=0; $x<$db->rows; $x++) {
				$db->GetRow($x);
				$db->BagAndTag();
				$id = $db->data[SeasonID];
				$seasonname = $db->data[SeasonName];
				// output article

			echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
			}
		}
			echo "</select></p>\n";
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "    </td>\n";
			echo "  </tr>\n";
			echo "</table>\n";

        }
}




function show_statistics_runswickets($db,$statistics)
{
        global $dbcfg, $PHP_SELF, $bluebdr, $greenbdr, $yellowbdr;

	$db->Query("SELECT * FROM seasons ORDER BY SeasonID");
	for ($i=0; $i<$db->rows; $i++) {
		$db->GetRow($i);
		$seasons[$db->data[SeasonID]] = $db->data[SeasonName];
	}
	
        if (!$db->Exists("
		SELECT 
		  g.season, n.SeasonName, 
		  t.TeamAbbrev, 
		  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, 
		  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
		FROM 
		  tennis_scorecard_batting_details s
		INNER JOIN
		  tennisplayers p 
		ON 
		  s.player_id = p.PlayerID
		INNER JOIN 
		  tennis_scorecard_game_details g
		ON
		  s.game_id = g.game_id
		INNER JOIN
		  tennisteams t
		ON 
		  p.PlayerTeam = t.TeamID
		INNER JOIN
		  seasons n 
		ON
		  g.season = n.SeasonID		  
		WHERE 
		  n.SeasonName LIKE '%{$statistics}%' 
		GROUP BY 
		  s.player_id
		ORDER BY
		  p.PlayerLName    
        ")) {

	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td align=\"left\" valign=\"top\">\n";

	echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
	echo "<tr>\n";
	echo "  <td align=\"left\" valign=\"top\">\n";
	echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
	echo "  </td>\n";
	echo "  <td align=\"right\" valign=\"top\">\n";
	require ("/home/colora12/public_html/tennis/includes/navtop.php");
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";


	echo "<b class=\"16px\">$statistics All-Rounders</b><br>Qualification: 25 Runs & 3 Wickets<br><br>\n";

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;All-Round Statistics</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";
	
	echo " There are no statistics for this year.\n";

	echo "</td>\n";
	echo "</tr>\n";
	echo "</table><br>\n";

// begin season selection

	if ($db->Exists("SELECT * FROM seasons")) {
	$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
	echo "  <tr>\n";
	echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
	echo "  </tr>\n";
	echo "  <tr>\n";
	echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

	echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
	echo "  <tr>\n";
	echo "    <td>\n";

	echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
	echo "  <option>select another season</option>\n";
	echo "  <option>=====================</option>\n";
	for ($x=0; $x<$db->rows; $x++) {
		$db->GetRow($x);
		$db->BagAndTag();
		$id = $db->data[SeasonID];
		$seasonname = $db->data[SeasonName];
		// output article

	echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
	}
}
	echo "</select></p>\n";
	echo "  </td>\n";
	echo "</tr>\n";
	echo "</table>\n";

			
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";
	
	echo "</td>\n";
	echo "</tr>\n";
	echo "</table>\n";	
			
                return;

        } else {


		 	echo "<table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\">\n";
		 	echo "  <tr>\n";
		 	echo "    <td align=\"left\" valign=\"top\">\n";

			echo "<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n";
			echo "<tr>\n";
			echo "  <td align=\"left\" valign=\"top\">\n";
			echo "  <a href=\"/index.php\">Home</a> &raquo; <a href=\"/statistics.php\">Statistics</a> &raquo; $statistics statistics</p>\n";
			echo "  </td>\n";
			echo "  <td align=\"right\" valign=\"top\">\n";
			require ("/home/colora12/public_html/tennis/includes/navtop.php");
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";


			echo "<b class=\"16px\">$statistics All-Rounders</b><br>Qualification: 25 Runs & 3 Wickets<br><br>\n";

// begin batting statistics

		    	echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$bluebdr\" align=\"center\">\n";
		    	echo "  <tr>\n";
		    	echo "    <td bgcolor=\"$bluebdr\" class=\"whitemain\" height=\"23\">&nbsp;Batting Statistics</td>\n";
        		echo "  </tr>\n";
        		echo "  <tr>\n";
			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

			echo "<table width=\"100%\" cellspacing=\"0\" cellpadding=\"2\">\n";
			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"25%\"><b>Name</b></td>\n";
			echo "  <td align=\"right\" width=\"9%\"><b>I</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>Runs</b></td>\n";
			echo "  <td align=\"right\" width=\"7%\"><b>HS</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>Ave</b></td>\n";
			echo "  <td align=\"right\" width=\"5%\"><b>Wkts</b></td>\n";
			echo "  <td align=\"right\" width=\"9%\"><b>Ave</b></td>\n";
			echo "  <td align=\"right\" width=\"10%\"><b>BB</b></td>\n";
			echo "  <td align=\"right\" width=\"15%\"><b>Team</b></td>\n";
			echo " </tr>\n";

			$db->Query("
					  SELECT 
					  g.season, n.SeasonName, 
					  t.TeamAbbrev, 
					  COUNT( s.player_id ) AS Matches, SUM( s.runs ) AS Runs, MAX( s.runs ) AS HS, 
					  s.player_id, p.PlayerID, LEFT(p.PlayerFName,1) AS PlayerInitial, p.PlayerFName, p.PlayerLName 
					FROM 
					  tennis_scorecard_batting_details s
					INNER JOIN
					  tennisplayers p 
					ON 
					  s.player_id = p.PlayerID
					INNER JOIN 
					  tennis_scorecard_game_details g
					ON
					  s.game_id = g.game_id
					INNER JOIN
					  tennisteams t
					ON 
					  p.PlayerTeam = t.TeamID
					INNER JOIN
					  seasons n 
					ON
					  g.season = n.SeasonID		  
					WHERE 
					  n.SeasonName LIKE '%{$statistics}%'
					GROUP BY
					  p.PlayerID
					ORDER BY 
					  Runs DESC
			");
			
			$db->BagAndTag();

			// instantiate new db class
			$subdb =& new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
			$subdb->SelectDB($dbcfg[db]);
		
			for ($r=0; $r<$db->rows; $r++) {
			$db->GetRow($r);			

			$playerid = $db->data[player_id];
			$init = $db->data[PlayerInitial];
			$fname = $db->data[PlayerFName];
			$lname = $db->data[PlayerLName];
			$teama = $db->data[TeamAbbrev];			
			$scinn = $db->data[Matches];
			$scrun = $db->data[Runs];
			$schig = $db->data[HS];				
			
			// Get Sum of Notouts
			
			$subdb->QueryRow("SELECT COUNT(b.how_out) AS Notout FROM tennis_scorecard_batting_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE (b.how_out = 2 OR b.how_out = 8) AND b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%'");
			if($subdb->data[Notout] != "0") {
			  $scnot = $subdb->data[Notout];	
			} else {
			  $scnot = "-";
			}
			
			$outin = $scinn - $scnot;

			if($scrun >= 1 && $outin >= 1) {
			$scavg = Number_Format(Round($scrun / $outin, 2),2);
			} else {
			$scavg = "-";
			}			
		
			// Get Sum of Runs Against
						
			$subruns = htmlentities(stripslashes($subdb->QueryItem("SELECT SUM(b.runs) AS Runs FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%'")));
			if($subruns != "") {
			  $scbru = $subruns;
			} else {
			  $scbru = "1";
			}
 
			// Get Sum of Wickets
			
			$subwic = htmlentities(stripslashes($subdb->QueryItem("SELECT SUM(b.wickets) AS Wickets FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%'")));
			if($subwic != "") {
			  $scwic = $subwic;
			} else {
			  $scwic = "1";
			}
	
			// Get Bowling Average
			
			if($scwic >= 1 && $scbru >= 1) {
			$scbav = Number_Format(Round($scbru / $scwic, 2),2);
			} else {
			$scbav = "-";
			}
			
			// Get Best Bowling Effort (Wickets)
			
			$exist1 = htmlentities(stripslashes($subdb->QueryItem("SELECT MAX(b.player_id) AS Player FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%'")));
			if($exist1 != "") {
			$subdb->QueryRow("SELECT b.wickets AS BWickets, b.runs AS BRuns FROM tennis_scorecard_bowling_details b INNER JOIN seasons s ON b.season = s.SeasonID WHERE b.player_id = $playerid AND s.SeasonName LIKE '%{$statistics}%' ORDER BY b.wickets DESC, b.runs ASC LIMIT 1");
			  $scbbr = $subdb->data[BRuns];  
			  $scbbw = $subdb->data[BWickets];  
			} else {
			  $scbbw = "-";
			  $scbbr = "-";
			}
			
			
			if($scrun >= "25" && $scwic >= "3") {

			echo " <tr>\n";
			echo "  <td align=\"left\" width=\"25%\"><a href=\"players.php?players=$playerid&ccl_mode=1\" class=\"scorecard\">";
			
			if($lname == "" && $fname == "") {
			  echo "";
			} elseif($fname != "" && $lname != "") {
			  echo "$init $lname";
			} else {
			  echo "$fname\n";
			}			
			
			echo "  </a></td>\n";
			echo "  <td align=\"right\" width=\"9%\">$scinn</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$scrun</td>\n";
			echo "  <td align=\"right\" width=\"7%\">$schig</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$scavg</td>\n";
			echo "  <td align=\"right\" width=\"5%\">$scwic</td>\n";
			echo "  <td align=\"right\" width=\"9%\">$scbav</td>\n";
			echo "  <td align=\"right\" width=\"10%\">$scbbw-$scbbr</td>\n";
			echo "  <td align=\"right\" width=\"15%\">$teama</td>\n";
			echo " </tr>\n";
			
			} else {
			}
			
			}
			
			echo "</table><br>\n";

			echo "</td>\n";
			echo "</tr>\n";
			echo "</table><br>\n";
			
			
// begin season selection

			if ($db->Exists("SELECT * FROM seasons")) {
			$db->QueryRow("SELECT * FROM seasons WHERE SeasonName NOT LIKE '%KO%' ORDER BY SeasonID DESC");

 		        echo "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"$yellowbdr\" align=\"center\">\n";
 		        echo "  <tr>\n";
 		        echo "    <td bgcolor=\"$yellowbdr\" class=\"whitemain\" height=\"23\">&nbsp;Season Selection</td>\n";
         		echo "  </tr>\n";
         		echo "  <tr>\n";
 			echo "  <td class=\"trrow1\" valign=\"top\" bordercolor=\"#FFFFFF\" class=\"main\" colspan=\"2\">\n";

 			echo "  <table width=\"100%\" cellpadding=\"10\" cellspacing=\"1\" border=\"0\">\n";
 			echo "  <tr>\n";
			echo "    <td>\n";

 			echo "<p><select name=ccl_mode onChange=\"gotosite(this.options[this.selectedIndex].value)\">\n";
			echo "  <option>select another season</option>\n";
			echo "  <option>=====================</option>\n";
			for ($x=0; $x<$db->rows; $x++) {
				$db->GetRow($x);
				$db->BagAndTag();
				$id = $db->data[SeasonID];
				$seasonname = $db->data[SeasonName];
				// output article

			echo "<option value=\"$PHP_SELF?statistics=$seasonname&ccl_mode=1\">" . $db->data[SeasonName] . "</option>\n";
			}
		}
			echo "</select></p>\n";
			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "  </td>\n";
			echo "</tr>\n";
			echo "</table>\n";

			echo "    </td>\n";
			echo "  </tr>\n";
			echo "</table>\n";

        }
}



// main program


// open up db connection now so you don't have to in every other file
$db = new mysql_class($dbcfg[login],$dbcfg[pword],$dbcfg[server]);
$db->SelectDB($dbcfg[db]);



switch($ccl_mode) {
case 0:
	show_statistics_listing($db,$statistics,$id,$pr,$team,$week,$game_id);
	break;
case 1:
	show_statistics($db,$statistics,$id,$pr,$team,$week,$game_id);
	break;
case 2:
	show_statistics_team($db,$statistics,$id,$pr,$team,$week,$game_id);
	break;
case 3:
	show_statistics_mostruns($db,$statistics,$sort,$sort2,$option,$team);
	break;	
case 4:
	show_statistics_bestinnings($db,$statistics);
	break;	
case 5:
	show_statistics_bowling($db,$statistics,$sort,$direction);
	break;
case 6:
	show_statistics_bestbowling($db,$statistics);
	break;	
case 7:
	show_statistics_runswickets($db,$statistics);
	break;		
case 8:
	show_statistics_bighits($db,$statistics,$sort);
	break;	
default:
	show_statistics_listing($db,$statistics,$id,$pr,$team,$week,$game_id);
	break;
}

?>
