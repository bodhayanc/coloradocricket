		<?php		//------------------------------------------------------------------------------		// Newsletter Subscription v 2.0		//		// (c) Andrew Collington - amnuts@talker.com		// (c) Michael Doig      - michael@coastart.net		// On behalf of Coastart Internet Services - all rights reserved.		//------------------------------------------------------------------------------		function do_add_subscription($db,$fname,$email)		{			global $PHP_SELF,$content,$action,$SID;			// make sure info is present and correct			if ($fname == "" || $email == "") {				echo "<p class=\"header\">Missing information</p>\n";				echo "<p>You must complete your name and email. Please try again.</p>\n";				return;			}			// setup variables			$fn = addslashes(trim($fname));			$em = addslashes(trim($email));			// check to see if it exists first			if ($db->Exists("SELECT * FROM demomailinglist_emails WHERE email='$em'")) {				echo "<p class=\"header\">Duplicate entry!</p>\n";				echo "<p>The email address <b>$em</b> already exists in the database. Please try using another email address.</p>\n";				return;			}			// all okay			$db->Insert("INSERT INTO demomailinglist_emails (listID,fname,lname,email,unsubscribed,htmlemail,date) VALUES (1,'$fname','','$email',0,1,NOW())");			if ($db->a_rows != -1) {				echo "<p class=\"header\">Thanks!</p>\n";				echo "<p>You have now subscribed to the newsletter list with the email <b>$em</b>. You'll start receiving our FREE newsletter soon! Thanks again.</p>\n";			} else {				echo "<p class=\"header\">Uh oh!</p>\n";				echo "<p>The email address <b>$em</b> could not be added to the database at this time. This is probably due to an error with the database, please try again.</p>\n";			}		}		// open up db connection now so you don't have to in every other file		$db = new mysql_class($dbcfg['login'],$dbcfg['pword'],$dbcfg['server']);		$db->SelectDB($dbcfg[db]);		do_add_subscription($db,$fname,$email);		?>